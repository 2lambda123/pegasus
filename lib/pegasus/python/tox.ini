[tox]

; Test for py26, py27, py35, py36, py37, py38
envlist  = py35


[testenv]

commands     = pytest --cov {toxinidir}/Pegasus {posargs}

passenv      = USER CPATH

setenv       = PYTHONUNBUFFERED   = yes
               PYTHONHASHSEED     = 1649596107

skip_install = {env:SKIP_INSTALL:False}

deps         = pytest
               pytest-mock
               coverage
               pytest-cov
               jsonschema
               pyOpenSSL


[testenv:py26]

deps         = pytest==3.2.5
               pyOpenSSL==0.14


[testenv:docs]

changedir    = ../../../doc/docbook

whitelist_externals = make

commands_pre = sphinx-apidoc     --force  --output-dir python {toxinidir}              {toxinidir}/{setup,test}.py {toxinidir}/Pegasus/{cluster,command,compat,exitcode,init,s3,submitdir,user}.py {toxinidir}/Pegasus/{test,db,monitoring,catalogs,cli,netlogger,plots_stats,service,tools}
               javasphinx-apidoc --update --output-dir java   {toxinidir}/../../../src {toxinidir}/../../../src/edu/isi/pegasus/aws/batch/common/

commands     = make html man

skipsdist    = True

skip_install = True

deps         = sphinx
               recommonmark
               sphinx_rtd_theme
               sphinxcontrib-openapi
               javasphinx
               sphinx_tabs
