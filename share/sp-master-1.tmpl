#!/bin/sh
#
# master file for dag @@DAXLABEL@@
# generated by @@USER@@
# generated on @@NOW@@

# purpose: write a timestamped log entry
log() {
    ( date +"%Y-%m-%dT%H:%M:%S" | tr '\012' ' '; echo "$*" ) >> $log_file
}

# purpose: insert entry into replica catalog, mappings on stdin
# paramtr: list (IN): file of file mappings: lfn pfn rest
insert_rc() 
{
    tmp=`mktemp /tmp/sp-rc.XXXXXX`
    here=`/bin/pwd`
    while read lfn pfn; do
	case "$pfn" in 
	    /*)
		echo "insert $lfn $pfn pool=\"local\"" >> $tmp
		;;
	    *)
		echo "insert $lfn $here/$pfn pool=\"local\"" >> $tmp
		;;
	esac
    done < $1
    echo "start rc-client -f $tmp"
    rc-client -f $tmp
    rm -f $tmp
}

# global variables -- for your information only
log_file="@@LOGFILE@@"
do_register="@@REGISTER@@"
kickstart="@@KICKSTART@@"

