#!/bin/sh
#
# job @@JOBID@@ for workflow @@DAXLABEL@@
# generated by @@USER@@
# generated on @@NOW@@
# xformation @@TR@@
# derivation @@DV@@

# 1st and only argument is the name of the log file
log_file=$1
shift

# purpose: write a timestamped log entry
log() {
    ( date +"%Y-%m-%dT%H:%M:%S" | tr '\012' ' '; echo "$*" ) >> $log_file
}

# purpose: check for the existence of output files
# paramtr: list (IN): file of file mappings: lfn pfn rest
check_output() {
    while read lfn pfn; do 
	if [ ! -e $pfn ]; then
	    return 1
	fi
    done < $1
}

# sanity check
if [ "X$log_file" = "X" ]; then
    log_file="$$"
    exit 1
fi

log @@JOBID@@ started
